<mxfile host="app.diagrams.net" modified="2024-06-24T11:57:22.427Z" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.0.0 Safari/537.36" etag="BBtKKX6INz54gzoHH-Ap" version="24.5.5" type="github">
  <diagram name="第 1 页" id="PkiXDes5N5bRzUGDbgQO">
    <mxGraphModel dx="794" dy="420" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-16" value="channel" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;" vertex="1" parent="1">
          <mxGeometry x="678" y="4800" width="142" height="250" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-18" value="kafka Selectable" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;horizontal=1;" parent="1" vertex="1">
          <mxGeometry x="200" y="4450" width="260" height="270" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-11" value="kafkaChannel" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="518" y="4110" width="224" height="300" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-10" value="selector" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#f5f5f5;fontColor=#333333;strokeColor=#666666;" parent="1" vertex="1">
          <mxGeometry x="199" y="4110" width="261" height="300" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-1" value="单机" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=center;verticalAlign=middle;size=18;" parent="1" vertex="1">
          <mxGeometry x="100" y="40" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-2" value="producer" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="100" y="150" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-3" value="kafka - broker - jvm" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="250" y="95" width="420" height="165" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-4" value="partition 0" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="290" y="145" width="330" height="65" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-35" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.75;entryDx=0;entryDy=0;strokeColor=#FF0000;" parent="1" source="Z7uTY06q8HQg-axiRB6t-5" target="Z7uTY06q8HQg-axiRB6t-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-5" value="cusumer" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="750" y="150" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-7" value="kernel" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="300" y="310" width="320" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-8" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="290" y="200" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-9" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="342" y="200" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-10" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="392" y="200" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-11" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="442" y="200" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-16" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=none;dashed=1;" parent="1" source="Z7uTY06q8HQg-axiRB6t-12" target="Z7uTY06q8HQg-axiRB6t-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-18" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;dashed=1;" parent="1" source="Z7uTY06q8HQg-axiRB6t-12" target="Z7uTY06q8HQg-axiRB6t-15" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-33" style="edgeStyle=orthogonalEdgeStyle;curved=0;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.75;entryDx=0;entryDy=0;strokeColor=#FF0000;" parent="1" source="Z7uTY06q8HQg-axiRB6t-12" target="Z7uTY06q8HQg-axiRB6t-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-12" value="pagecache" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="300" y="324" width="113" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="Z7uTY06q8HQg-axiRB6t-2" target="Z7uTY06q8HQg-axiRB6t-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-15" value="磁盘&lt;div&gt;文件方式保存数据&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="267" y="440" width="400" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-17" value="写磁盘就会有个粒度，写的粒度越小，速度越慢&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;trade off&lt;/div&gt;&lt;div&gt;我们应该把单机的持久化可靠性转向集群多机方式&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=left;verticalAlign=top;size=18;" parent="1" vertex="1">
          <mxGeometry x="140" y="310" width="140" height="110" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-19" value="data" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="267" y="490" width="170" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-24" value="" style="group" parent="1" vertex="1" connectable="0">
          <mxGeometry x="270" y="520" width="139" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-20" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="Z7uTY06q8HQg-axiRB6t-24" vertex="1">
          <mxGeometry width="34.92462311557789" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-21" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="Z7uTY06q8HQg-axiRB6t-24" vertex="1">
          <mxGeometry x="36.321608040201006" width="34.92462311557789" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-22" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="Z7uTY06q8HQg-axiRB6t-24" vertex="1">
          <mxGeometry x="71.2462311557789" width="34.92462311557789" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-23" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="Z7uTY06q8HQg-axiRB6t-24" vertex="1">
          <mxGeometry x="106.17085427135679" width="32.82914572864322" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-26" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="Z7uTY06q8HQg-axiRB6t-25" target="Z7uTY06q8HQg-axiRB6t-19" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-25" value="index&lt;div&gt;offset&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="480" y="490" width="75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-28" value="" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="Z7uTY06q8HQg-axiRB6t-27" target="Z7uTY06q8HQg-axiRB6t-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-27" value="index&lt;div&gt;timestamp&lt;/div&gt;" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="596" y="490" width="75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-34" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=1;entryDx=0;entryDy=0;exitX=0.75;exitY=1;exitDx=0;exitDy=0;strokeColor=#FF0000;strokeWidth=1;" parent="1" source="Z7uTY06q8HQg-axiRB6t-32" target="Z7uTY06q8HQg-axiRB6t-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="610" y="405.86" as="sourcePoint" />
            <mxPoint x="844.3553390593274" y="235.00213562373096" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-32" value="sendfile(in,offset.out)" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="481" y="326" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-14" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Z7uTY06q8HQg-axiRB6t-3" target="Z7uTY06q8HQg-axiRB6t-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-36" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.75;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;strokeColor=#FF0000;" parent="1" source="Z7uTY06q8HQg-axiRB6t-3" target="Z7uTY06q8HQg-axiRB6t-32" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-37" value="注意零拷贝不经过用户空间，但是必须保证pagecache里面有，没有的话，需要进行构建" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=left;verticalAlign=top;size=18;" parent="1" vertex="1">
          <mxGeometry x="620" y="260" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-42" value="分区可靠性，要解决一个问题，伴随着引入更多的问题" style="shape=singleArrow;whiteSpace=wrap;html=1;arrowWidth=0.33855612618582587;arrowSize=0.11218369646770199;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="50" y="560" width="820" height="70" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-43" value="producer" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="30" y="925" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-44" value="kafka - broker - jvm" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="251" y="700" width="420" height="145" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-45" value="partition 0 leader" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="291" y="740" width="330" height="55" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-46" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="291" y="785" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-47" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="343" y="785" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-48" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="393" y="785" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-49" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="443" y="785" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-50" value="生产者角度" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=center;verticalAlign=top;size=18;" parent="1" vertex="1">
          <mxGeometry x="130" y="640" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-51" value="kafka不是一个读写分离的组件，所以prducer只能向分区的leader进行发送消息&lt;div&gt;consumer只能向分区拉取数据&lt;/div&gt;" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="216" y="620" width="510" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-52" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="Z7uTY06q8HQg-axiRB6t-43" target="Z7uTY06q8HQg-axiRB6t-45" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-53" value="kafka - broker - jvm" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="251" y="870" width="420" height="145" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-54" value="partition 0 follower" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="291" y="910" width="330" height="55" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-55" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="291" y="955" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-56" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="343" y="955" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-57" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="393" y="955" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-58" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="443" y="955" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-59" value="kafka - broker - jvm" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="250" y="1050" width="420" height="145" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-60" value="partition 0 follower" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;" parent="1" vertex="1">
          <mxGeometry x="290" y="1090" width="330" height="55" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-61" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="290" y="1135" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-62" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="342" y="1135" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-63" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="392" y="1135" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-64" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="442" y="1135" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-65" value="cusumer" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="790" y="917.5" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-66" value="一致性&lt;div style=&quot;font-size: 14px;&quot;&gt;1. 强一致性，所有节点必须全部存活，&lt;span style=&quot;background-color: initial; font-size: 14px;&quot;&gt;一致性破坏了可用性&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;2-1. 最终一致性，过半通过，最常用的分布式一致性解决方案&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;2-2. ISR(in sync replicas) 连通性&amp;amp;活跃性&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;OSR(outof-sync replicas),超过阈值时间，没有心跳&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;AR(Assigned) 面向分区的副本集合，创建topic的时候你给出了分区的副本数，那么controller在创建时候就已经分配了brocker和分区的对应关系，并且得到了该分区的brocker集合&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;AR = ISR + OSR&lt;/div&gt;&lt;div style=&quot;font-size: 14px;&quot;&gt;ack = -1&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=left;verticalAlign=top;size=18;fontStyle=1;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="50" y="1220" width="460" height="180" as="geometry" />
        </mxCell>
        <mxCell id="Z7uTY06q8HQg-axiRB6t-67" value="ack&amp;nbsp;&lt;div&gt;1 默认值，只需要leader写入pagecache就可以&lt;/div&gt;&lt;div&gt;-1 最严苛 所有的ISR副本都要同步，一致&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffe6cc;strokeColor=#d79b00;horizontal=1;align=left;verticalAlign=top;size=18;" parent="1" vertex="1">
          <mxGeometry x="20" y="715" width="220" height="70" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-1" value="ISR代表和Leader一直在通信的节点&lt;div&gt;OSR代表超过阈值时间（10S）没有进行通信的数据 kafka这种方式，不要求过半同步，只要求ISR必须进行同步。&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=left;verticalAlign=top;size=18;fontSize=14;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="541" y="1220" width="279" height="180" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-2" value="producer" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="13" y="1870" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-3" value="kafka - broker - jvm" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="157.5" y="1627.5" width="420" height="145" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-4" value="partition 0 leader" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="197.5" y="1667.5" width="330" height="55" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-5" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="197.5" y="1712.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-6" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="249.5" y="1712.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-7" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="299.5" y="1712.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-8" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="349.5" y="1712.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-9" value="消费者角度" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=center;verticalAlign=top;size=18;" parent="1" vertex="1">
          <mxGeometry x="63" y="1570" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-10" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="034WyvBDw2LTuWk4lug2-2" target="034WyvBDw2LTuWk4lug2-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-11" value="kafka - broker - jvm" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="157.5" y="1797.5" width="420" height="145" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-12" value="partition 0 follower" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="197.5" y="1837.5" width="330" height="55" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-13" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="197.5" y="1882.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-14" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="249.5" y="1882.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-15" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="299.5" y="1882.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-16" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="349.5" y="1882.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-17" value="kafka - broker - jvm" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="156.5" y="1977.5" width="420" height="145" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-18" value="partition 0 follower" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="196.5" y="2017.5" width="330" height="55" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-19" value="1" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="196.5" y="2062.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-20" value="2" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="248.5" y="2062.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-21" value="3" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="298.5" y="2062.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-22" value="4" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="348.5" y="2062.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-23" value="cusumer" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="726" y="1870" width="100" height="40" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-25" value="AR" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="705" y="750" width="45" height="410" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-26" value="ISR" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="640" y="750" width="47" height="250" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-27" value="OSR" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="640" y="1050" width="47" height="110" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-28" value="分布式集群" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=center;verticalAlign=top;size=18;" parent="1" vertex="1">
          <mxGeometry x="13" y="640" width="80" height="40" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-29" value="" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;direction=south;notch=0;fillColor=#f0a30a;fontColor=#000000;strokeColor=#BD7000;" parent="1" vertex="1">
          <mxGeometry x="393" y="1580" width="27" height="583.5" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-30" value="5" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="413" y="1712.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-31" value="6" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="463" y="1712.5" width="50" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-33" value="" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;direction=south;notch=0;fillColor=#f0a30a;fontColor=#000000;strokeColor=#BD7000;" parent="1" vertex="1">
          <mxGeometry x="500.5" y="1580" width="27" height="152.5" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-36" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.316;entryY=0.588;entryDx=0;entryDy=0;entryPerimeter=0;curved=1;" parent="1" source="034WyvBDw2LTuWk4lug2-23" target="034WyvBDw2LTuWk4lug2-29" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-37" value="High Watemark&lt;div style=&quot;font-size: 12px;&quot;&gt;HW&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=center;verticalAlign=middle;size=18;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="361.5" y="1530" width="90" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-38" value="LogEndOffset&lt;div style=&quot;font-size: 12px;&quot;&gt;LEO&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=center;verticalAlign=middle;size=18;fontSize=12;fontStyle=1" parent="1" vertex="1">
          <mxGeometry x="463" y="1530" width="117" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-40" value="对于消费者来说，只能消费HW的数据&lt;div&gt;5，6是leader已经写入page cache 但是还没有更新给follower的数据&lt;/div&gt;&lt;div&gt;对于leader来说，也不会给5，6进行ack，只有同步了的数据才会进行ack --------------------(ack = -1)&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#ffff88;strokeColor=none;horizontal=1;align=left;verticalAlign=top;size=18;fontSize=14;" parent="1" vertex="1">
          <mxGeometry x="601" y="1943" width="229" height="137" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-41" value="生产是生产，消费是消费" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;fillColor=#ffe6cc;strokeColor=#d79b00;" parent="1" vertex="1">
          <mxGeometry x="37" y="1440" width="790" height="50" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-42" value="0，另外一个trade off 不要强调磁盘的可靠性，转向异地多级的同步&lt;div&gt;1. 如果拿磁盘做持久化，在做trade off&lt;div&gt;有限pagecache或者绝对磁盘&lt;/div&gt;&lt;div&gt;2，在多机集群分布式的时候 trade off 强一致性，最终一致性(过半，ISR)&lt;/div&gt;&lt;div&gt;*: redis 宁可用HA,不用刻意追求AOF的准确性&lt;/div&gt;&lt;div&gt;&amp;nbsp;像kafka，我们追求ack -1不要太追求磁盘的可靠性&lt;/div&gt;&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;horizontal=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="20" y="2180" width="390" height="100" as="geometry" />
        </mxCell>
        <mxCell id="034WyvBDw2LTuWk4lug2-43" value="lsof -Pnp 3462&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;index文件都是 mem&lt;/div&gt;&lt;div&gt;log文件都是&amp;nbsp; u&lt;/div&gt;&lt;div&gt;问题：.log为啥不用mmap?&lt;/div&gt;&lt;div&gt;mmap或者普通io log使用普通io的形式目的是通用性&lt;/div&gt;&lt;div&gt;数据存入磁盘的可靠性级别&lt;/div&gt;&lt;div&gt;app级别，&lt;/div&gt;&lt;div&gt;调用了io的write,但是这个时候只到达了内核，性能快，但是会丢数据，只有NIO的filechannel，你调用了write + force，才能真正的写道磁盘。&lt;/div&gt;" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;horizontal=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="30" y="2380" width="340" height="170" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-2" value="生产者" style="html=1;shadow=0;dashed=0;align=center;verticalAlign=middle;shape=mxgraph.arrows2.arrow;dy=0.6;dx=40;notch=0;" parent="1" vertex="1">
          <mxGeometry x="20" y="2580" width="800" height="70" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-7" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;" parent="1" source="v6fSQlxzGpSbIA0BIh1v-5" target="v6fSQlxzGpSbIA0BIh1v-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-10" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;" parent="1" source="v6fSQlxzGpSbIA0BIh1v-5" target="v6fSQlxzGpSbIA0BIh1v-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-11" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.75;entryY=0;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" edge="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="392" y="2720" as="sourcePoint" />
            <mxPoint x="120.5" y="3010" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-5" value="KafkaProducer&lt;div&gt;线程安全&lt;/div&gt;" style="shape=hexagon;perimeter=hexagonPerimeter2;whiteSpace=wrap;html=1;fixedSize=1;" parent="1" vertex="1">
          <mxGeometry x="361.5" y="2660" width="148.5" height="80" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-8" value="线程B" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="60" y="2900" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-9" value="线程C" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="60" y="3010" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-4" value="线程A" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="60" y="2790" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-14" style="edgeStyle=orthogonalEdgeStyle;rounded=1;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;curved=1;dashed=1;" parent="1" source="v6fSQlxzGpSbIA0BIh1v-12" target="v6fSQlxzGpSbIA0BIh1v-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-12" value="IO thread: Sender" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="273" y="2770" width="307" height="180" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-13" value="brockers&lt;div&gt;kafka集群&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="687" y="2960" width="144.5" height="80" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-16" style="edgeStyle=orthogonalEdgeStyle;curved=1;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=12;startSize=8;endSize=8;dashed=1;" parent="1" source="v6fSQlxzGpSbIA0BIh1v-15" target="v6fSQlxzGpSbIA0BIh1v-13" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-15" value="IO thread: Sender" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="273" y="2990" width="307" height="180" as="geometry" />
        </mxCell>
        <mxCell id="v6fSQlxzGpSbIA0BIh1v-17" value="分区内的数据是有序的" style="shape=note;whiteSpace=wrap;html=1;backgroundOutline=1;darkOpacity=0.05;fillColor=#fff2cc;strokeColor=#d6b656;horizontal=1;align=left;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="665" y="2760" width="165" height="100" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-1" value="Record Accumulator&amp;nbsp;&amp;nbsp;&lt;span style=&quot;font-style: italic; font-size: 10.5pt; white-space: pre;&quot;&gt;BUFFER_MEMORY_CONFIG&lt;/span&gt;" style="whiteSpace=wrap;html=1;verticalAlign=top;fontFamily=Helvetica;fontColor=default;labelBackgroundColor=#FFFFFF;" parent="1" vertex="1">
          <mxGeometry x="213" y="3240" width="387" height="240" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-2" value="topic" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="257" y="3280" width="60" height="90" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-3" value="topic" style="whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="257" y="3380" width="60" height="90" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-4" value="partition-X" style="rounded=1;whiteSpace=wrap;html=1;align=right;" parent="1" vertex="1">
          <mxGeometry x="344.25" y="3280" width="255.75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-5" value="partition-Y" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="337" y="3330" width="223" height="40" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-6" value="partition-X" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="337" y="3380" width="223" height="40" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-7" value="partition-Y" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="337" y="3430" width="223" height="40" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-8" value="Producer&lt;div&gt;Batch&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="344.25" y="3270" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-9" value="Producer&lt;div&gt;Batch&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="408.75" y="3270" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="IShY9MJZ5aXx8t9KCvCx-11" value="Producer&lt;div&gt;Batch&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="469" y="3270" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eLV7LrER7qPHKsvqjfjF-2" value="Producer&amp;nbsp;&lt;span style=&quot;background-color: initial;&quot;&gt;Batch&amp;nbsp; &amp;nbsp;BATCH_SIZE_CONFIG&lt;/span&gt;" style="whiteSpace=wrap;html=1;verticalAlign=top;" parent="1" vertex="1">
          <mxGeometry x="213.75" y="3520" width="387" height="100" as="geometry" />
        </mxCell>
        <mxCell id="eLV7LrER7qPHKsvqjfjF-1" value="head key value" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="212.25" y="3570" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eLV7LrER7qPHKsvqjfjF-3" value="head key value" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="273.75" y="3570" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eLV7LrER7qPHKsvqjfjF-4" value="head key value" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="335.25" y="3570" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eLV7LrER7qPHKsvqjfjF-5" value="head key value" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="398" y="3570" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eLV7LrER7qPHKsvqjfjF-6" value="head key value" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="459.5" y="3570" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="eLV7LrER7qPHKsvqjfjF-7" value="head key value" style="ellipse;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="519.75" y="3570" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="dS4TRO4Wpcu3B6O6hNNI-1" value="kafkaChannel" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=top;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="200" y="3910" width="550" height="130" as="geometry" />
        </mxCell>
        <mxCell id="dS4TRO4Wpcu3B6O6hNNI-2" value="NetworkSend" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="541" y="3955" width="75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="dS4TRO4Wpcu3B6O6hNNI-4" value="muteState" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#dae8fc;strokeColor=#6c8ebf;" parent="1" vertex="1">
          <mxGeometry x="630" y="3955" width="75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;curved=1;" parent="1" source="dS4TRO4Wpcu3B6O6hNNI-8" target="vwyWo56KM6DLtkNVk9hy-16" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-31" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="dS4TRO4Wpcu3B6O6hNNI-8" target="vwyWo56KM6DLtkNVk9hy-30" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="397" y="4390" />
              <mxPoint x="500" y="4390" />
              <mxPoint x="500" y="4365" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="dS4TRO4Wpcu3B6O6hNNI-8" value="select" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="363" y="4260" width="80" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="vwyWo56KM6DLtkNVk9hy-1" target="vwyWo56KM6DLtkNVk9hy-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-1" value="Client" style="rounded=0;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="43" y="4170" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-3" value="send" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="363" y="4170" width="79" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;" parent="1" source="vwyWo56KM6DLtkNVk9hy-12" target="dS4TRO4Wpcu3B6O6hNNI-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-15" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="vwyWo56KM6DLtkNVk9hy-12" target="vwyWo56KM6DLtkNVk9hy-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-12" value="setSend" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="539" y="4170" width="79" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;curved=1;" parent="1" source="vwyWo56KM6DLtkNVk9hy-3" target="vwyWo56KM6DLtkNVk9hy-12" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-9" value="write&amp;nbsp;&lt;div&gt;event&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="643" y="4175" width="49" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-5" value="NetworkSend" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="529" y="4080" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-27" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="vwyWo56KM6DLtkNVk9hy-16" target="vwyWo56KM6DLtkNVk9hy-25" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-28" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="vwyWo56KM6DLtkNVk9hy-16" target="vwyWo56KM6DLtkNVk9hy-21" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="572" y="4520" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-16" value="write&amp;nbsp;&lt;div&gt;event&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="547" y="4260" width="49" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-19" value="nioSelector" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="212.5" y="4490" width="75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-20" value="channels" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="212.5" y="4570" width="75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-21" value="completedSends" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="323" y="4490" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-22" value="completedReceives" style="rounded=0;whiteSpace=wrap;html=1;align=center;verticalAlign=middle;fillColor=#fff2cc;strokeColor=#d6b656;" parent="1" vertex="1">
          <mxGeometry x="323" y="4570" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-24" value="NetworkSend" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="720" y="4460" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-25" value="IO" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="820" y="4480" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-29" value="NetworkSend" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="487.5" y="4470" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-32" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=1;entryDx=0;entryDy=0;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" parent="1" source="vwyWo56KM6DLtkNVk9hy-30" target="vwyWo56KM6DLtkNVk9hy-25" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="641" y="4560" />
              <mxPoint x="880" y="4560" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-34" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=1;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="vwyWo56KM6DLtkNVk9hy-30" target="vwyWo56KM6DLtkNVk9hy-22" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="641" y="4600" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-30" value="read&amp;nbsp;&lt;div&gt;event&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" parent="1" vertex="1">
          <mxGeometry x="616" y="4340" width="49" height="50" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-33" value="NetworkReceive" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="720" y="4565" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="vwyWo56KM6DLtkNVk9hy-35" value="NetworkReceive" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" parent="1" vertex="1">
          <mxGeometry x="492" y="4560" width="40" height="40" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="4vZclOJh9Q1g4vMz1hYF-1" target="4vZclOJh9Q1g4vMz1hYF-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-1" value="Producer&lt;div&gt;Record&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry y="4895" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="4vZclOJh9Q1g4vMz1hYF-2" target="4vZclOJh9Q1g4vMz1hYF-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-2" value="Record Accumulator&amp;nbsp;&amp;nbsp;&lt;span style=&quot;font-style: italic; font-size: 10.5pt; white-space: pre;&quot;&gt;BUFFER_MEMORY_CONFIG&lt;/span&gt;" style="whiteSpace=wrap;html=1;verticalAlign=top;fontFamily=Helvetica;fontColor=default;labelBackgroundColor=#FFFFFF;" vertex="1" parent="1">
          <mxGeometry x="100.5" y="4800" width="400" height="250" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-3" value="topic" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="136.5" y="4840" width="60" height="90" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-4" value="topic" style="whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="136.5" y="4940" width="60" height="90" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-5" value="partition-X" style="rounded=1;whiteSpace=wrap;html=1;align=right;" vertex="1" parent="1">
          <mxGeometry x="223.75" y="4840" width="255.75" height="40" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-6" value="partition-Y" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="216.5" y="4890" width="223" height="40" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-7" value="partition-X" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="216.5" y="4940" width="223" height="40" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-8" value="partition-Y" style="rounded=1;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="216.5" y="4990" width="223" height="40" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-9" value="Producer&lt;div&gt;Batch&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="223.75" y="4830" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-10" value="Producer&lt;div&gt;Batch&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="288.25" y="4830" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-11" value="Producer&lt;div&gt;Batch&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="348.5" y="4830" width="58.5" height="50" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-18" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="4vZclOJh9Q1g4vMz1hYF-13" target="4vZclOJh9Q1g4vMz1hYF-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-13" value="Producer&lt;div&gt;Record&lt;/div&gt;" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="536" y="4895" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-15" value="request" style="ellipse;whiteSpace=wrap;html=1;aspect=fixed;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="692" y="4895" width="60" height="60" as="geometry" />
        </mxCell>
        <mxCell id="4vZclOJh9Q1g4vMz1hYF-17" value="write&amp;nbsp;&lt;div&gt;event&lt;/div&gt;" style="rhombus;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="760" y="4900" width="49" height="50" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
